<!doctype html>
<html lang="en">
<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

	<!-- CSS Link -->
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/map.css') }}">

	<!--Mapbox-->
	<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.js'></script>
	<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.css' rel='stylesheet' />

	<title>Segurança Negligenciada?</title>
</head>
<body>

	<div id="map"></div>	
	<input type="checkbox" id="check">
	<label id="icone" for="check"><img src="../static/bg_img/menu.png" width="40px"></label>

	<div class="barra">

		<nav class="menu-map" id="listing-group">
			<div class="menu-title">
				Plotagens 
			</div>
			<a data-toggle="modal" data-target="#incentivoFiscal"><div class="link">Maior Incentivo Fiscal</div></a>
			<a id="renda1"><div class="link">Renda 1</div></a>
			<a id="renda2"><div class="link">Renda 2</div></a>
			<a id="renda3"><div class="link">Renda 3</div></a>
			<a id="marcacoesMaisCaras"><div class="link">Marcações + Caras!</div></a>
			<a id="removerMarcacoes"><div class="link">Remover Marcações</div></a>



			<div class="menu-title">
				Filtros 
			</div>
			<a data-toggle="modal" data-target="#cadastrar"><div class="link">Selecionar Filtros</div></a>




			<div class="menu-title">
				Voar pelo mapa (regiões)
			</div>


			<a><div class="link"  type="button" value="VG" id="visaoGeral">Visão Geral</div></a>
			<a><div class="link"  type="button" value="NT" id="norte">Norte</div></a>
			<a><div class="link"  type="button" value="ND" id="nordeste">Nordeste</div></a>
			<a><div class="link"  type="button" value="CO" id="centro-oeste">Centro-Oeste</div></a>
			<a><div class="link"  type="button" value="SD" id="sudeste">Sudeste</div></a>
			<a><div class="link"  type="button" value="SUL" id="sul">Sul</div></a>




		</nav>
	</div>	



	<div class="modal fade" id="incentivoFiscal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<p>Localidades com maior incentivo fiscal pelo MCMV</p>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-3">
							<div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
								<a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">Como funciona</a>
								<a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">Regiões</a>
								<a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab" aria-controls="v-pills-messages" aria-selected="false">Estados</a>
								<a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab" aria-controls="v-pills-settings" aria-selected="false">Cidades</a>
							</div>
						</div>
						<div class="col-9">
							<div class="tab-content" id="v-pills-tabContent">
								<div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab"><p class="paragrafos">O programa "Minha Casa Minha Vida" tem por objetivo oferecer condições atrativas para o financiamento de moradias urbanas para famílias de baixa renda. Neste relatório é capaz de encontrar gráficos que demonstram como tem sido distribuído os recursos através das macro-regiões, os estados e os municípios.</p></div>
								<div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
									<div id="containerRegioes" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
								</div>
								<div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
									<div id="containerEstados" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
								</div>
								<div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">
									<div id="containerCidades" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>


	{%with messages = get_flashed_messages()%}
	{%if messages%}
	{% for message in messages %}
	<div class="alert alert-success alert-dismissable" role="alert">
		<button type="button" class="close" data-dismiss="alert" aria-label ="close">
			<span aria-hidden="true">&times;</span>
		</button>
		{{message}}
	</div>
	{%endfor%}
	{%endif%}
	{%endwith%}

	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>

	<script src="{{ url_for('static', filename='js/custom.js') }}"></script>
	<script src="{{ url_for('static', filename='js/removerMarcacoes.js') }}"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


	<script type="text/javascript">
		document.getElementById("renda1").onclick = function () { 
			'{% for row in getValor %}'
				if('{{row.4}}' == "Faixa 1"){
					var code = '<h4 class="popup-title-r2">' + '{{ row.3 }}' +' / '+ '{{ row.2 }}'+'</h4>'
					+'<p class="popup-content">Unidades Habitacionais: '+ '{{ row.5 }}' + '</br>'
					+'Valor investido: '+ '{{row.6 }}' + '</br>'
					+'Renda: '+ '{{row.4 }}' + '</p>';

					  // create the popup
					  var popup = new mapboxgl.Popup({ closeButton: false,
					  	closeOnClick: true, offset: 25 })
					  .setHTML(code);

					// create DOM element for the marker
					var el = document.createElement('div');
					el.id = 'marker-r1';

					// create the marker
					new mapboxgl.Marker(el)
					.setLngLat(['{{row.0}}', '{{row.1}}'])
					    .setPopup(popup) // sets a popup on this marker
					    .addTo(map);
					}

			'{% endfor %}'
		};

		document.getElementById("renda2").onclick = function () { 
			'{% for row in getValor %}'
			if('{{row.4}}' == "Faixa 2"){
				var code = '<h4 class="popup-title-r2">' + '{{ row.3 }}' +' / '+ '{{ row.2 }}'+'</h4>'
				+'<p class="popup-content">Unidades Habitacionais: '+ '{{ row.5 }}' + '</br>'
				+'Valor investido: '+ '{{row.6 }}' + '</br>'
				+'Renda: '+ '{{row.4 }}' + '</p>';

				  // create the popup
				  var popup = new mapboxgl.Popup({ closeButton: false,
				  	closeOnClick: true, offset: 25 })
				  .setHTML(code);

				// create DOM element for the marker
				var el = document.createElement('div');
				el.id = 'marker-r2';

				// create the marker
				new mapboxgl.Marker(el)
				.setLngLat(['{{row.0}}', '{{row.1}}'])
				    .setPopup(popup) // sets a popup on this marker
				    .addTo(map);
				}

				'{% endfor %}'
		};

		document.getElementById("renda3").onclick = function () { 
			'{% for row in getValor %}'
			if('{{row.4}}' == "Faixa 3"){
				var code = '<h4 class="popup-title-r3">' + '{{ row.3 }}' +' / '+ '{{ row.2 }}'+'</h4>'
				+'<p class="popup-content">Unidades Habitacionais: '+ '{{ row.5 }}' + '</br>'
				+'Valor investido: '+ '{{row.6 }}' + '</br>'
				+'Renda: '+ '{{row.4 }}' + '</p>';

				  // create the popup
				  var popup = new mapboxgl.Popup({ closeButton: false,
				  	closeOnClick: true, offset: 25 })
				  .setHTML(code);

				// create DOM element for the marker
				var el = document.createElement('div');
				el.id = 'marker-r3';

				// create the marker
				new mapboxgl.Marker(el)
				.setLngLat(['{{row.0}}', '{{row.1}}'])
				    .setPopup(popup) // sets a popup on this marker
				    .addTo(map);
				}

				'{% endfor %}'
		};

		document.getElementById("marcacoesMaisCaras").onclick = function () { 

			'{% for row in getValor %}'
			if('{{row.5}}' > 50){
				var code = '<h4 class="popup-title">' + '{{ row.3 }}' +' / '+ '{{ row.2 }}'+'</h4>'
				+'<p class="popup-content">Unidades Habitacionais: '+ '{{ row.5 }}' + '</br>'
				+'Valor investido: '+ '{{row.6 }}' + '</br>'
				+'Renda: '+ '{{row.4 }}' + '</p>';

				  // create the popup
				  var popup = new mapboxgl.Popup({ closeButton: false,
				  	closeOnClick: true, offset: 25 })
				  .setHTML(code);

				// create DOM element for the marker
				var el = document.createElement('div');
				el.id = 'marker';

				// create the marker
				new mapboxgl.Marker(el)
				.setLngLat(['{{row.0}}', '{{row.1}}'])
				    .setPopup(popup) // sets a popup on this marker
				    .addTo(map);
				}

				'{% endfor %}'
			};


		</script>
	</body>
	</html>